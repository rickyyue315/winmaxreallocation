# 🧪 數據可視化功能測試指南

**測試版本**: v1.5  
**測試日期**: 2025-09-17  

## 🎯 測試目標

驗證新增的數據可視化功能是否正常工作，包括：
1. 條形圖正確生成
2. 顏色配置正確
3. 數值標籤顯示
4. 底部水印更新

## 📋 測試步驟

### 1. 啟動應用
```bash
cd /workspace
streamlit run app.py --server.address 0.0.0.0 --server.port 8501
```

### 2. 上傳測試數據
- 準備包含多個OM的Excel文件
- 確保有轉出和接收的調貨記錄

### 3. 運行分析
- 點擊"開始分析"按鈕
- 等待處理完成

### 4. 檢查結果

#### 4.1 統計分析部分
✅ 檢查項目：
- [ ] 統計表格正常顯示
- [ ] "按OM統計"表格包含"涉及行數"欄位
- [ ] 新增圖表區域顯示

#### 4.2 條形圖檢查
✅ 檢查項目：
- [ ] 圖表標題："各OM轉出vs接收調貨數量統計"
- [ ] X軸顯示所有OM單位
- [ ] Y軸顯示調貨數量
- [ ] 轉出數量條形圖為青藍色 (#4682B4)
- [ ] 接收數量條形圖為青綠色 (#20B2AA)
- [ ] 條形圖上方顯示數值標籤
- [ ] 圖例正確顯示"轉出數量"和"接收數量"

#### 4.3 水印檢查
✅ 檢查項目：
- [ ] 頁面底部顯示："由 Ricky 開發 | © 2025"

## 🔍 測試用例

### 測試用例1: 基本功能
**測試數據**: 包含2-3個OM，每個都有轉出和接收記錄
**預期結果**: 生成包含對比條形圖的完整分析報告

### 測試用例2: 單向調貨
**測試數據**: 某個OM只有轉出沒有接收
**預期結果**: 圖表中該OM的接收數量顯示為0

### 測試用例3: 無數據
**測試數據**: 沒有生成任何調貨建議的數據
**預期結果**: 顯示"沒有數據可用於生成圖表"

## ⚠️ 常見問題

### 問題1: 圖表不顯示
**可能原因**: matplotlib庫未正確安裝
**解決方案**: 
```bash
pip install matplotlib seaborn
```

### 問題2: 中文字體顯示異常
**可能原因**: 系統缺少中文字體
**解決方案**: 字體已配置多個備選方案，應該自動降級

### 問題3: 圖表生成錯誤
**可能原因**: 數據格式問題
**解決方案**: 檢查錯誤消息，數據預處理邏輯會處理大部分問題

## 📊 成功標準

✅ **基本功能**: 所有核心調貨功能正常工作  
✅ **圖表顯示**: 條形圖正確生成並顯示  
✅ **顏色正確**: 青藍色轉出、青綠色接收  
✅ **數據準確**: 圖表數值與統計表格一致  
✅ **用戶體驗**: 界面美觀，無錯誤提示  
✅ **水印更新**: 顯示正確的開發者信息  

## 🎉 測試完成

當所有檢查項目都通過時，表示數據可視化優化功能已成功實施！

---

**📞 支持信息**
- 版本: v1.5
- 核心功能: 調貨建議生成 + 數據可視化
- 技術棧: Streamlit + Pandas + Matplotlib + Seaborn
