# 🧪 調貨數量優化功能測試案例

**測試目標**: 驗證1件調貨自動調高至2件的優化功能

## 測試數據設計

### 測試場景1: 可以調高的情況

| Article | OM | RP Type | Site | SaSa Net Stock | Safety Stock | Last Month Sold Qty |
|---------|----|---------|----- |---------------|--------------|---------------------|
| 123456789012 | HK01 | ND | S001 | 10 | 0 | 0 |
| 123456789012 | HK01 | RF | S002 | 6 | 4 | 5 |

**預期結果**:
- S001 (ND類型) 可轉出10件
- S002 (RF類型) 需要補充1件 (6+0-4=2 < 4)
- 原始計算: 調貨1件 (min(10, 1) = 1)
- 優化檢查: 10-2 = 8 >= 0 ✅ 且 可轉數量(10) >= 2 ✅
- **最終結果**: 調貨2件

### 測試場景2: 不能調高的情況

| Article | OM | RP Type | Site | SaSa Net Stock | Safety Stock | Last Month Sold Qty |
|---------|----|---------|----- |---------------|--------------|---------------------|
| 123456789013 | HK01 | ND | S003 | 8 | 0 | 0 |
| 123456789013 | HK01 | RF | S004 | 7 | 6 | 5 |

**預期結果**:
- S003 (ND類型) 可轉出8件
- S004 (RF類型) 需要補充1件 (7+0-6=1 < 6)
- 原始計算: 調貨1件 (min(8, 1) = 1)
- 優化檢查: 無需檢查(ND轉出到RF接收，沒有安全庫存限制)
- **最終結果**: 調貨1件 (實際上ND類型轉出沒有安全庫存限制，這個場景需要調整)

### 修正測試場景2: RF過剩轉出的情況

| Article | OM | RP Type | Site | SaSa Net Stock | Safety Stock | Last Month Sold Qty |
|---------|----|---------|----- |---------------|--------------|---------------------|
| 123456789013 | HK01 | RF | S005 | 8 | 7 | 2 |
| 123456789013 | HK01 | RF | S006 | 5 | 6 | 8 |

**預期結果**:
- S005 (RF類型) 可轉出1件 (8-7=1，且銷量不是最高)
- S006 (RF類型) 需要補充1件 (5+0-6=-1 < 6，且銷量是最高)
- 原始計算: 調貨1件
- 優化檢查: 8-2 = 6 < 7 ❌
- **最終結果**: 調貨1件 (保持不變)

## 功能驗證步驟

1. **上傳測試數據**: 使用包含上述測試場景的Excel文件
2. **運行分析**: 點擊"開始分析"按鈕
3. **檢查結果**: 驗證調貨數量是否按預期調整
4. **下載報告**: 檢查Excel輸出中的調貨數量

## 驗證要點

✅ **場景1驗證**: 1件調貨應該調高到2件  
✅ **場景2驗證**: 不符合條件的1件調貨保持不變  
✅ **安全檢查**: 轉出店鋪調貨後存貨 >= Safety Stock  
✅ **邏輯完整**: 優化不影響其他調貨邏輯  

---

**📝 測試記錄**
- 測試日期: 2025-09-15
- 測試版本: v1.3
- 測試結果: ✅ 通過
